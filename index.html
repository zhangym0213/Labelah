<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub 视频 & JSON 预览</title>
    <style>
        body {
            display: flex;
            height: 100vh;
            margin: 0;
        }
        #videoSection {
            flex: 3;
            display: flex;
            flex-direction: column;
            padding: 10px;
            border-right: 2px solid #ccc;
        }
        #textSection {
            flex: 2;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }
        input, select {
            margin-bottom: 10px;
            padding: 5px;
            width: 100%;
        }
        video {
            width: 100%;
            height: auto;
            max-height: 80vh;
        }
        textarea {
            width: 100%;
            height: 80vh;
            resize: none;
        }
    </style>
</head>
<body>
    <!-- 左侧视频区域 -->
    <div id="videoSection">
        <h3>搜索视频</h3>
        <input type="text" id="videoSearch" placeholder="输入视频名称">
        <select id="videoList" size="5"></select>
        <video id="videoPlayer" controls></video>
    </div>

    <!-- 右侧文字区域 -->
    <div id="textSection">
        <h3>搜索 JSON 文件</h3>
        <input type="text" id="jsonSearch" placeholder="输入 JSON 文件名称">
        <select id="jsonList" size="5"></select>
        <textarea id="jsonViewer" readonly></textarea>
    </div>

    <script>
        const repoOwner = "zhangym0213";  // GitHub 用户名
        const repoName = "Labelah";       // GitHub 仓库名

        // 加载视频文件列表
        async function loadVideos() {
            const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/videos`;
            const res = await fetch(url);
            const data = await res.json();
            const videoList = document.getElementById("videoList");

            data.forEach(file => {
                if (file.name.endsWith(".mp4") || file.name.endsWith(".webm")) {
                    let option = document.createElement("option");
                    option.value = file.download_url;
                    option.textContent = file.name;
                    videoList.appendChild(option);
                }
            });

            videoList.addEventListener("change", () => {
                document.getElementById("videoPlayer").src = videoList.value;
            });
        }

        // 加载 JSON 文件列表
        async function loadJsonFiles() {
            const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/data`;
            const res = await fetch(url);
            const data = await res.json();
            const jsonList = document.getElementById("jsonList");

            data.forEach(file => {
                if (file.name.endsWith(".json")) {
                    let option = document.createElement("option");
                    option.value = file.download_url;
                    option.textContent = file.name;
                    jsonList.appendChild(option);
                }
            });

            jsonList.addEventListener("change", async () => {
                const res = await fetch(jsonList.value);
                const content = await res.json();
                document.getElementById("jsonViewer").value = JSON.stringify(content, null, 2);
            });
        }

        // 过滤搜索功能
        function setupSearch(inputId, listId) {
            document.getElementById(inputId).addEventListener("input", function () {
                const filter = this.value.toLowerCase();
                const options = document.getElementById(listId).options;

                for (let option of options) {
                    option.style.display = option.textContent.toLowerCase().includes(filter) ? "" : "none";
                }
            });
        }

        // 初始化
        loadVideos();
        loadJsonFiles();
        setupSearch("videoSearch", "videoList");
        setupSearch("jsonSearch", "jsonList");
    </script>
</body>
</html>
